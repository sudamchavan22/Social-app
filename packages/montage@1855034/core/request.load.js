montageDefine("1855034","core/request",{dependencies:["./promise"],factory:function(e,t,n){var r=e("./promise").Promise;t=n.exports=function(e){e=t.normalizeRequest(e);var n=r.defer(),i=e.xhr||new XMLHttpRequest;i.open(e.method,e.url,!0),i.onload=function(){var e={status:i.status,headers:t.parseResponseHeaders(i.getAllResponseHeaders()),body:i.response,xhr:i};n.resolve(e)},i.onerror=function(){n.reject(Error("Could not load"))};var a=e.headers;for(var o in a){var s=a[o];if(Array.isArray(s))for(var l=0;s.length>l;l++)i.setRequestHeader(o,s[l]);else i.setRequestHeader(o,s)}var u=e.options;for(var c in u)i[c]=u[c];return e.overrideMimeType&&i.overrideMimeType(e.overrideMimeType),i.send(e.body),n.promise},t.request=t,t.makeOk=function(e){return function(n){n=t.normalizeRequest(n);var i=n.url;return r.when(e(n),function(e){if(e.status>=200&&300>e.status)return e;var t=Error("Could not load "+JSON.stringify(i)+": "+e.status+" "+e.xhr.statusText);throw t.response=e,t})}},t.ok=t.makeOk(t.request),t.makeJson=function(e){return function(n){n=t.normalizeRequest(n);var i=n.url;return n.headers.accept=n.headers.accept||"application/json",n.headers["content-type"]=n.headers["content-type"]||"application/json","object"==typeof n.body&&(n.body=JSON.stringify(n.body)),n.overrideMimeType=n.overrideMimeType||"application/json",n.options.responseType=n.options.responseType||"json",r.when(e(n),function(e){if(null===e.body||"string"==typeof e.body)try{e.body=JSON.parse(e.body)}catch(t){throw Error("Could not parse JSON from "+JSON.stringify(i)+": "+t.message)}return e})}},t.json=t.makeJson(t.request),t.normalizeRequest=function(e){return"string"==typeof e&&(e={url:e}),e.method=e.method||"GET",e.headers=e.headers||{},e.options=e.options||{},e},t.parseResponseHeaders=function(e){var t={};return e?(e.replace(/^([^:]+):(.*)$/gm,function(e,n,r){n=n.trim().toLowerCase(),r=r.trim(),n in t?("string"==typeof t[n]&&(t[n]=[t[n]]),t[n].push(r)):t[n]=r}),t):t}}});