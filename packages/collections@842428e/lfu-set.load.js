montageDefine("842428e","lfu-set",{dependencies:["./shim","./set","./generic-collection","./generic-set","./listen/property-changes","./listen/range-changes","lfu-set"],factory:function(e,t,n){"use strict";function i(e,t,n,r,a){return this instanceof i?(t=t||1/0,n=n||Object.equals,r=r||Object.hash,a=a||Function.noop,this.store=new s(void 0,function(e,t){return n(e.value,t.value)},function(e){return r(e.value)}),this.frequencyHead=new this.FrequencyNode(0),this.contentEquals=n,this.contentHash=r,this.getDefault=a,this.capacity=t,this.length=0,this.addEach(e),void 0):new i(e,t,n,r,a)}function r(e,t){this.value=e,this.frequencyNode=t}function a(e,t,n){this.frequency=e,this.values=new s,this.prev=t||this,this.next=n||this,t&&(t.next=this),n&&(n.prev=this)}e("./shim");var s=e("./set"),o=e("./generic-collection"),l=e("./generic-set"),c=e("./listen/property-changes"),u=e("./listen/range-changes");n.exports=i,i.LfuSet=i,Object.addEach(i.prototype,o.prototype),Object.addEach(i.prototype,l.prototype),Object.addEach(i.prototype,c.prototype),Object.addEach(i.prototype,u.prototype),i.prototype.constructClone=function(e){return new this.constructor(e,this.capacity,this.contentEquals,this.contentHash,this.getDefault)},i.prototype.has=function(e){return this.store.has(new this.Node(e))},i.prototype.get=function(e,t){if(t)throw Error("LfuSet#get does not support second argument: equals");var n=this.store.get(new this.Node(e));if(void 0!==n){var i=n.frequencyNode,r=i.next;return r.frequency!==i.frequency+1&&(r=new this.FrequencyNode(i.frequency+1,i,r)),r.values.add(n),n.frequencyNode=r,i.values["delete"](n),0===i.values.length&&(i.prev.next=i.next,i.next.prev=i.prev),n.value}return this.getDefault(e)},i.prototype.add=function(e){if(this.has(e))return this.get(e),!1;var t,n,i=[],r=[];if(this.capacity>0){i.push(e),this.length+1>this.capacity&&(t=this.frequencyHead.next,n=t.values.order.head.next.value,r.push(n.value)),this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(i,r,0),r.length>0&&(this.store["delete"](n),t.values["delete"](n),1!==t.value&&0===t.values.length&&(this.frequencyHead.next=t.next,t.next.prev=this.frequencyHead));var a=new this.Node(e),s=this.frequencyHead.next;1!==s.frequency&&(s=new this.FrequencyNode(1,this.frequencyHead,s)),this.store.add(a),s.values.add(a),a.frequencyNode=s,this.length=this.length+i.length-r.length,this.dispatchesRangeChanges&&this.dispatchRangeChange(i,r,0)}return i.length!==r.length},i.prototype["delete"]=function(e,t){if(t)throw Error("LfuSet#delete does not support second argument: equals");var n=this.store.get(new this.Node(e)),i=!!n;if(i){this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],0);var r=n.frequencyNode;this.store["delete"](n),r.values["delete"](n),0===r.values.length&&(r.prev.next=r.next,r.next.prev=r.prev),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],0)}return i},i.prototype.one=function(){return this.length>0?this.frequencyHead.next.values.one().value:void 0},i.prototype.clear=function(){this.store.clear(),this.frequencyHead.next=this.frequencyHead,this.length=0},i.prototype.reduce=function(e,t){for(var n=arguments[2],i=0,r=this.frequencyHead.next;0!==r.frequency;){var a=r.values;t=a.reduce(function(t,r){return e.call(n,t,r.value,i++,this)},t,this),r=r.next}return t},i.prototype.reduceRight=function(e,t){for(var n=arguments[2],i=this.length-1,r=this.frequencyHead.prev;0!==r.frequency;){var a=r.values;t=a.reduceRight(function(t,r){return e.call(n,t,r.value,i--,this)},t,this),r=r.prev}return t},i.prototype.iterate=function(){return this.store.map(function(e){return e.value}).iterate()},i.prototype.Node=r,i.prototype.FrequencyNode=a}});