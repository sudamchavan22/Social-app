function parseRanges(e){for(var t=[],n=e.split(","),i=0;n.length>i;i++)t.push(exports.parseMediaRange(n[i]));return t}exports.parseMimeType=function(e){for(var t,n,i={},r=e.split(";"),a=0;r.length>a;a++){var s=r[a].split("=");2===s.length&&(i[s[0].trim()]=s[1].trim())}return t=r[0].replace(/^\s+/,"").replace(/\s+$/,""),"*"===t&&(t="*/*"),n=t.split("/"),[n[0],n[1],i]},exports.parseMediaRange=function(e){var t,n=exports.parseMimeType(e);return n[2].q?(t=parseFloat(n[2].q),isNaN(t)?n[2].q="1":(t>1||0>t)&&(n[2].q="1")):n[2].q="1",n},exports.fitnessAndQualityParsed=function(e,t){for(var n=-1,i=0,r=exports.parseMediaRange(e),a=r[0],s=r[1],o=r[2],l=0;t.length>l;l++){var c=t[l],u=c[0],h=c[1],p=c[2];if(!(u!==a&&"*"!==u&&"*"!==a||h!==s&&"*"!==h&&"*"!==s)){var d=0;for(var f in o)"q"!==f&&p[f]&&p[f]===o[f]&&(d+=1);var m=u===a?100:0;m+=h===s?10:0,m+=d,m>n&&(n=m,i=p.q)}}return[n,parseFloat(i)]},exports.qualityParsed=function(e,t){return exports.fitnessAndQualityParsed(e,t)[1]},exports.quality=function(e,t){return exports.qualityParsed(e,parseRanges(t))},exports.bestMatch=function(e,t){for(var n=parseRanges(t),i=[],r=0;e.length>r;r++)i.push([exports.fitnessAndQualityParsed(e[r],n),e[r]]);return i.sort(),i[i.length-1][0][1]?i[i.length-1][1]:""};