montageDefine("07f2c2d","fs2http",{dependencies:["q","./http","url"],factory:function(e,t){function n(e){var s=Object.create(n.prototype);return s.request=function(t){return r.when(t,function(t){t=i.normalizeRequest(t);var n=a.parse(t.url);if("file:"!==n.protocol)return{status:404,headers:{},body:["Can't access protocol "+n.protocol]};var r=n.pathname;return e.open(r,{charset:t.charset}).then(function(e){return{status:200,headers:{},body:e}})})},s.read=function(e,n){return n=n||function(e){return 200===e.status},r.when(t.request(e),function(e){if(!n(e)){var t=Error("HTTP request failed with code "+e.status);throw t.response=e,t}return r.invoke(e.body,"read")})},s}var r=e("q"),i=e("./http"),a=e("url");t.Client=n,t.request=function(t){return r.fcall(e.async||e,"./fs").then(function(e){return n(e).request(t)})},t.read=function(t){return r.fcall(e.async||e,"./fs").then(function(e){return n(e).read(t)})}}});