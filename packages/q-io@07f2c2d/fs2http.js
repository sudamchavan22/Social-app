function Client(e){var t=Object.create(Client.prototype);return t.request=function(t){return Q.when(t,function(t){t=HTTP.normalizeRequest(t);var n=URL.parse(t.url);if("file:"!==n.protocol)return{status:404,headers:{},body:["Can't access protocol "+n.protocol]};var r=n.pathname;return e.open(r,{charset:t.charset}).then(function(e){return{status:200,headers:{},body:e}})})},t.read=function(e,t){return t=t||function(e){return 200===e.status},Q.when(exports.request(e),function(e){if(!t(e)){var n=Error("HTTP request failed with code "+e.status);throw n.response=e,n}return Q.invoke(e.body,"read")})},t}var Q=require("q"),HTTP=require("./http"),URL=require("url");exports.Client=Client,exports.request=function(e){return Q.fcall(require.async||require,"./fs").then(function(t){return Client(t).request(e)})},exports.read=function(e){return Q.fcall(require.async||require,"./fs").then(function(t){return Client(t).read(e)})};